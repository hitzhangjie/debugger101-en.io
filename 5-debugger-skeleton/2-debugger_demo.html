
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>5.2 Debugger Example · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-md-toc/style.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../6-develop-inst-debugger/" />
    
    
    <link rel="prev" href="1-debugger_skeleton.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    1 Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../2-preface/">
            
                <a href="../2-preface/">
            
                    
                    2 Preface
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../3-terms/">
            
                <a href="../3-terms/">
            
                    
                    3 Common Terms
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../4-basics/">
            
                <a href="../4-basics/">
            
                    
                    4 Software Debugging Basics
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../4-basics/1-purposes.html">
            
                <a href="../4-basics/1-purposes.html">
            
                    
                    4.1 Debugging Purposes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../4-basics/2-dependencies.html">
            
                <a href="../4-basics/2-dependencies.html">
            
                    
                    4.2 Debugging Dependencies
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../4-basics/3-countertactics.html">
            
                <a href="../4-basics/3-countertactics.html">
            
                    
                    4.3 Anti-Debugging Techniques
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="./">
            
                <a href="./">
            
                    
                    5 Entering Debugger Development
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="1-debugger_skeleton.html">
            
                <a href="1-debugger_skeleton.html">
            
                    
                    5.1 Debugger Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.5.2" data-path="2-debugger_demo.html">
            
                <a href="2-debugger_demo.html">
            
                    
                    5.2 Debugger Example
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../6-develop-inst-debugger/">
            
                <a href="../6-develop-inst-debugger/">
            
                    
                    6 Developing Go Instruction-Level Debugger
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../6-develop-inst-debugger/1-process_start.html">
            
                <a href="../6-develop-inst-debugger/1-process_start.html">
            
                    
                    6.1 Process Launch
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../6-develop-inst-debugger/2-process_attach.html">
            
                <a href="../6-develop-inst-debugger/2-process_attach.html">
            
                    
                    6.2 Process Attach
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../6-develop-inst-debugger/3-process_start_attach.html">
            
                <a href="../6-develop-inst-debugger/3-process_start_attach.html">
            
                    
                    6.3 Launch & Attach
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="../6-develop-inst-debugger/4-debug-session.html">
            
                <a href="../6-develop-inst-debugger/4-debug-session.html">
            
                    
                    6.4 Debug Session
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5" data-path="../6-develop-inst-debugger/5-disassemble.html">
            
                <a href="../6-develop-inst-debugger/5-disassemble.html">
            
                    
                    6.5 Disassembly
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.6" data-path="../6-develop-inst-debugger/6-breakpoint.html">
            
                <a href="../6-develop-inst-debugger/6-breakpoint.html">
            
                    
                    6.6 Adding Breakpoints
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.7" data-path="../6-develop-inst-debugger/7-breakpoints.html">
            
                <a href="../6-develop-inst-debugger/7-breakpoints.html">
            
                    
                    6.7 Listing Breakpoints
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.8" data-path="../6-develop-inst-debugger/8-clear.html">
            
                <a href="../6-develop-inst-debugger/8-clear.html">
            
                    
                    6.8 Removing Breakpoints
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.9" data-path="../6-develop-inst-debugger/9-clearall.html">
            
                <a href="../6-develop-inst-debugger/9-clearall.html">
            
                    
                    6.9 Clearing All Breakpoints
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.10" data-path="../6-develop-inst-debugger/10-step.html">
            
                <a href="../6-develop-inst-debugger/10-step.html">
            
                    
                    6.10 Stepping Operations
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.11" data-path="../6-develop-inst-debugger/11-continue.html">
            
                <a href="../6-develop-inst-debugger/11-continue.html">
            
                    
                    6.11 Running to Breakpoint
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.12" data-path="../6-develop-inst-debugger/12-pmem.html">
            
                <a href="../6-develop-inst-debugger/12-pmem.html">
            
                    
                    6.12 Printing Memory Data
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.13" data-path="../6-develop-inst-debugger/13-pregs.html">
            
                <a href="../6-develop-inst-debugger/13-pregs.html">
            
                    
                    6.13 Printing Register Data
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.14" data-path="../6-develop-inst-debugger/14-set-mem.html">
            
                <a href="../6-develop-inst-debugger/14-set-mem.html">
            
                    
                    6.14 Modifying Memory Data
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.15" data-path="../6-develop-inst-debugger/15-set-regs.html">
            
                <a href="../6-develop-inst-debugger/15-set-regs.html">
            
                    
                    6.15 Modifying Register Data
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.16" data-path="../6-develop-inst-debugger/20-trace_new_threads.html">
            
                <a href="../6-develop-inst-debugger/20-trace_new_threads.html">
            
                    
                    6.20 Tracing Multi-threaded Programs 1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.17" data-path="../6-develop-inst-debugger/21-trace_old_threads.html">
            
                <a href="../6-develop-inst-debugger/21-trace_old_threads.html">
            
                    
                    6.21 Tracing Multi-threaded Programs 2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.18" data-path="../6-develop-inst-debugger/80-aslr.html">
            
                <a href="../6-develop-inst-debugger/80-aslr.html">
            
                    
                    6.80 Understanding ASLR
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.19" data-path="../6-develop-inst-debugger/99-more.html">
            
                <a href="../6-develop-inst-debugger/99-more.html">
            
                    
                    6.99 More...
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../7-headto-sym-debugger/">
            
                <a href="../7-headto-sym-debugger/">
            
                    
                    7 Advancing to Symbol-Level Debugger
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../7-headto-sym-debugger/1-how-go-build-works.html">
            
                <a href="../7-headto-sym-debugger/1-how-go-build-works.html">
            
                    
                    7.1 Go Build Internals
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../7-headto-sym-debugger/2-elf.html">
            
                <a href="../7-headto-sym-debugger/2-elf.html">
            
                    
                    7.2 Understanding ELF Files
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="../7-headto-sym-debugger/3-syms.html">
            
                <a href="../7-headto-sym-debugger/3-syms.html">
            
                    
                    7.3 Symbols & Symbol Tables
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.4" data-path="../7-headto-sym-debugger/4-syms-resolve-reloc.html">
            
                <a href="../7-headto-sym-debugger/4-syms-resolve-reloc.html">
            
                    
                    7.4 Symbol Resolution & Relocation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.5" data-path="../7-headto-sym-debugger/5-loading.html">
            
                <a href="../7-headto-sym-debugger/5-loading.html">
            
                    
                    7.5 Loading
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.6" data-path="../7-headto-sym-debugger/6-gopkg-debug/">
            
                <a href="../7-headto-sym-debugger/6-gopkg-debug/">
            
                    
                    7.6 Go Standard Library debug/*
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.6.1" data-path="../7-headto-sym-debugger/6-gopkg-debug/1-elf.html">
            
                <a href="../7-headto-sym-debugger/6-gopkg-debug/1-elf.html">
            
                    
                    7.6.1 debug/elf
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.6.2" data-path="../7-headto-sym-debugger/6-gopkg-debug/2-gosym.html">
            
                <a href="../7-headto-sym-debugger/6-gopkg-debug/2-gosym.html">
            
                    
                    7.6.2 debug/gosym
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.6.3" data-path="../7-headto-sym-debugger/6-gopkg-debug/3-dwarf.html">
            
                <a href="../7-headto-sym-debugger/6-gopkg-debug/3-dwarf.html">
            
                    
                    7.6.3 debug/dwarf
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7.7" data-path="../7-headto-sym-debugger/7-headto-dwarf/">
            
                <a href="../7-headto-sym-debugger/7-headto-dwarf/">
            
                    
                    7.7 Advancing to DWARF
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.7.1" data-path="../7-headto-sym-debugger/7-headto-dwarf/1-gopkgs-about-dwarf.html">
            
                <a href="../7-headto-sym-debugger/7-headto-dwarf/1-gopkgs-about-dwarf.html">
            
                    
                    7.7.1 Related Go Packages
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.7.2" data-path="../7-headto-sym-debugger/7-headto-dwarf/2-delve-into-internals.html">
            
                <a href="../7-headto-sym-debugger/7-headto-dwarf/2-delve-into-internals.html">
            
                    
                    7.7.2 How to Crack Those Details
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.7.3" data-path="../7-headto-sym-debugger/7-headto-dwarf/3-compiler-gen-dwarfdata.html">
            
                <a href="../7-headto-sym-debugger/7-headto-dwarf/3-compiler-gen-dwarfdata.html">
            
                    
                    7.7.3 Compiler Generated DWARF Data
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.7.4" data-path="../7-headto-sym-debugger/7-headto-dwarf/4-linker-gen-dwarfdata.html">
            
                <a href="../7-headto-sym-debugger/7-headto-dwarf/4-linker-gen-dwarfdata.html">
            
                    
                    7.7.4 Linker Generated DWARF Data
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.7.5" data-path="../7-headto-sym-debugger/7-headto-dwarf/5-headto-dwarf.html">
            
                <a href="../7-headto-sym-debugger/7-headto-dwarf/5-headto-dwarf.html">
            
                    
                    7.7.5 Understanding DWARF
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../8-dwarf/">
            
                <a href="../8-dwarf/">
            
                    
                    8 Debug Information Standard: DWARF
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../8-dwarf/1-history.html">
            
                <a href="../8-dwarf/1-history.html">
            
                    
                    8.1 DWARF Development History
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="../8-dwarf/2-overview.html">
            
                <a href="../8-dwarf/2-overview.html">
            
                    
                    8.2 DWARF Content Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="../8-dwarf/3-dwarfdata.html">
            
                <a href="../8-dwarf/3-dwarfdata.html">
            
                    
                    8.3 DWARF Data Classification
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.4" data-path="../8-dwarf/4-die/">
            
                <a href="../8-dwarf/4-die/">
            
                    
                    8.4 DIE Detailed Introduction
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.4.1" data-path="../8-dwarf/4-die/1-desc-data-type.html">
            
                <a href="../8-dwarf/4-die/1-desc-data-type.html">
            
                    
                    8.4.1 DIE Describing Data and Types
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.4.2" data-path="../8-dwarf/4-die/2-desc-locations.html">
            
                <a href="../8-dwarf/4-die/2-desc-locations.html">
            
                    
                    8.4.2 Location Data
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.4.3" data-path="../8-dwarf/4-die/3-desc-code.html">
            
                <a href="../8-dwarf/4-die/3-desc-code.html">
            
                    
                    8.4.3 DIE Describing Executable Code
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.4.4" data-path="../8-dwarf/4-die/4-encoding.html">
            
                <a href="../8-dwarf/4-die/4-encoding.html">
            
                    
                    8.4.4 DIE Data Encoding
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8.5" data-path="../8-dwarf/5-other/">
            
                <a href="../8-dwarf/5-other/">
            
                    
                    8.5 Other Debug Data
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.5.1" data-path="../8-dwarf/5-other/1-accelerated-access.html">
            
                <a href="../8-dwarf/5-other/1-accelerated-access.html">
            
                    
                    8.5.1 Accelerated Access
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.5.2" data-path="../8-dwarf/5-other/2-lineno-table.html">
            
                <a href="../8-dwarf/5-other/2-lineno-table.html">
            
                    
                    8.5.2 Line Number Table Information
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.5.3" data-path="../8-dwarf/5-other/3-callframe-info.html">
            
                <a href="../8-dwarf/5-other/3-callframe-info.html">
            
                    
                    8.5.3 Call Frame Information
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.5.4" data-path="../8-dwarf/5-other/4-macro-info.html">
            
                <a href="../8-dwarf/5-other/4-macro-info.html">
            
                    
                    8.5.4 Macro Information
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.5.5" data-path="../8-dwarf/5-other/5-varlen-data.html">
            
                <a href="../8-dwarf/5-other/5-varlen-data.html">
            
                    
                    8.5.5 Variable Length Data
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.5.6" data-path="../8-dwarf/5-other/6-shrink-data.html">
            
                <a href="../8-dwarf/5-other/6-shrink-data.html">
            
                    
                    8.5.6 Compressed DWARF Data
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.5.7" data-path="../8-dwarf/5-other/7-elf-sections.html">
            
                <a href="../8-dwarf/5-other/7-elf-sections.html">
            
                    
                    8.5.7 ELF Sections
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8.6" data-path="../8-dwarf/6-practices.html">
            
                <a href="../8-dwarf/6-practices.html">
            
                    
                    8.6 DWARF Parsing and Applications
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.7" data-path="../8-dwarf/7-summary.html">
            
                <a href="../8-dwarf/7-summary.html">
            
                    
                    8.7 Summary
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../9-develop-sym-debugger/">
            
                <a href="../9-develop-sym-debugger/">
            
                    
                    9 Developing Go Symbol-Level Debugger
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="../9-develop-sym-debugger/1-架构设计/">
            
                <a href="../9-develop-sym-debugger/1-架构设计/">
            
                    
                    9.1 Architecture Design
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1.1" data-path="../9-develop-sym-debugger/1-架构设计/1-现代调试器架构.html">
            
                <a href="../9-develop-sym-debugger/1-架构设计/1-现代调试器架构.html">
            
                    
                    9.1.1 Modern Debugger Architecture
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.1.2" data-path="../9-develop-sym-debugger/1-架构设计/2-前端UI层设计.html">
            
                <a href="../9-develop-sym-debugger/1-架构设计/2-前端UI层设计.html">
            
                    
                    9.1.2 Frontend UI Layer Design
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.1.3" data-path="../9-develop-sym-debugger/1-架构设计/3-Service层设计.html">
            
                <a href="../9-develop-sym-debugger/1-架构设计/3-Service层设计.html">
            
                    
                    9.1.3 Service Layer Design
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.1.4" data-path="../9-develop-sym-debugger/1-架构设计/4-后端符号层设计.html">
            
                <a href="../9-develop-sym-debugger/1-架构设计/4-后端符号层设计.html">
            
                    
                    9.1.4 Backend Symbol Layer Design
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.1.5" data-path="../9-develop-sym-debugger/1-架构设计/5-后端目标层设计.html">
            
                <a href="../9-develop-sym-debugger/1-架构设计/5-后端目标层设计.html">
            
                    
                    9.1.5 Backend Target Layer Design
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.1.6" data-path="../9-develop-sym-debugger/1-架构设计/6-日志系统设计.html">
            
                <a href="../9-develop-sym-debugger/1-架构设计/6-日志系统设计.html">
            
                    
                    9.1.6 Logging System Design
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="../9-develop-sym-debugger/2-核心调试逻辑/">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/">
            
                    
                    9.2 Core Debugging Logic
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.2.1" data-path="../9-develop-sym-debugger/2-核心调试逻辑/00-cmds.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/00-cmds.html">
            
                    
                    9.2.00 Core Debugging Commands
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.2" data-path="../9-develop-sym-debugger/2-核心调试逻辑/01-debug-session.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/01-debug-session.html">
            
                    
                    9.2.01 Opening Debug Session
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.3" data-path="../9-develop-sym-debugger/2-核心调试逻辑/11-tinydbg_attach.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/11-tinydbg_attach.html">
            
                    
                    9.2.11 tinydbg attach
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.4" data-path="../9-develop-sym-debugger/2-核心调试逻辑/12-tinydbg_attach_waitfor.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/12-tinydbg_attach_waitfor.html">
            
                    
                    9.2.12 tinydbg attach+waitfor
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.5" data-path="../9-develop-sym-debugger/2-核心调试逻辑/13-tinydbg_exec.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/13-tinydbg_exec.html">
            
                    
                    9.2.13 tinydbg exec
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.6" data-path="../9-develop-sym-debugger/2-核心调试逻辑/14-tinydbg_debug.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/14-tinydbg_debug.html">
            
                    
                    9.2.14 tinydbg debug
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.7" data-path="../9-develop-sym-debugger/2-核心调试逻辑/15-tinydbg_core1.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/15-tinydbg_core1.html">
            
                    
                    9.2.15 tinydbg core - part1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.8" data-path="../9-develop-sym-debugger/2-核心调试逻辑/15-tinydbg_core2.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/15-tinydbg_core2.html">
            
                    
                    9.2.15 tinydbg core - part2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.9" data-path="../9-develop-sym-debugger/2-核心调试逻辑/16-tinydbg_connect.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/16-tinydbg_connect.html">
            
                    
                    9.2.16 tinydbg connect
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.10" data-path="../9-develop-sym-debugger/2-核心调试逻辑/17-tinydbg_trace.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/17-tinydbg_trace.html">
            
                    
                    9.2.17 tinydbg trace
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.11" data-path="../9-develop-sym-debugger/2-核心调试逻辑/21-disassemble.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/21-disassemble.html">
            
                    
                    9.2.21 tinydbg> disass
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.12" data-path="../9-develop-sym-debugger/2-核心调试逻辑/22-breakpoint.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/22-breakpoint.html">
            
                    
                    9.2.22 tinydbg> breakpoint
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.13" data-path="../9-develop-sym-debugger/2-核心调试逻辑/23-breakpoints.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/23-breakpoints.html">
            
                    
                    9.2.23 tinydbg> breakpoints
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.14" data-path="../9-develop-sym-debugger/2-核心调试逻辑/24-clear.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/24-clear.html">
            
                    
                    9.2.24 tinydbg> clear | toggle
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.15" data-path="../9-develop-sym-debugger/2-核心调试逻辑/25-clearall.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/25-clearall.html">
            
                    
                    9.2.25 tinydbg> clearall
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.16" data-path="../9-develop-sym-debugger/2-核心调试逻辑/26-step.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/26-step.html">
            
                    
                    9.2.26 tinydbg> next | step | stepi
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.17" data-path="../9-develop-sym-debugger/2-核心调试逻辑/27-continue.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/27-continue.html">
            
                    
                    9.2.27 Continue Execution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.18" data-path="../9-develop-sym-debugger/2-核心调试逻辑/28-pmem.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/28-pmem.html">
            
                    
                    9.2.28 View Memory
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.19" data-path="../9-develop-sym-debugger/2-核心调试逻辑/29-regs.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/29-regs.html">
            
                    
                    9.2.29 View Registers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.20" data-path="../9-develop-sym-debugger/2-核心调试逻辑/30-call-frame.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/30-call-frame.html">
            
                    
                    9.2.30 Call Frame Information
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.21" data-path="../9-develop-sym-debugger/2-核心调试逻辑/31-vars.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/31-vars.html">
            
                    
                    9.2.31 Variables & Type System
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.22" data-path="../9-develop-sym-debugger/2-核心调试逻辑/32-how_listfunctions_work.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/32-how_listfunctions_work.html">
            
                    
                    9.2.32 how ListFunctions work
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.23" data-path="../9-develop-sym-debugger/2-核心调试逻辑/32-funcs.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/32-funcs.html">
            
                    
                    9.2.32 funcs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.24" data-path="../9-develop-sym-debugger/2-核心调试逻辑/33-goroutines.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/33-goroutines.html">
            
                    
                    9.2.33 Goroutines
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.25" data-path="../9-develop-sym-debugger/2-核心调试逻辑/34-multi-threads.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/34-multi-threads.html">
            
                    
                    9.2.34 Tracing Multi-threaded Programs
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9.3" data-path="../9-develop-sym-debugger/3-高级功能扩展/">
            
                <a href="../9-develop-sym-debugger/3-高级功能扩展/">
            
                    
                    9.3 Advanced Feature Extensions
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.3.1" data-path="../9-develop-sym-debugger/3-高级功能扩展/100-howto_integrate_starlark.html">
            
                <a href="../9-develop-sym-debugger/3-高级功能扩展/100-howto_integrate_starlark.html">
            
                    
                    9.3.100 Integrating starlark
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3.2" data-path="../9-develop-sym-debugger/3-高级功能扩展/101-howto_tracing_via_ebpf.html">
            
                <a href="../9-develop-sym-debugger/3-高级功能扩展/101-howto_tracing_via_ebpf.html">
            
                    
                    9.3.101 Tracing with eBPF
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3.3" data-path="../9-develop-sym-debugger/3-高级功能扩展/102-howto_syntax_highlight.html">
            
                <a href="../9-develop-sym-debugger/3-高级功能扩展/102-howto_syntax_highlight.html">
            
                    
                    9.3.102 Implementing Syntax Highlighting
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3.4" data-path="../9-develop-sym-debugger/3-高级功能扩展/103-howto_paging_output.html">
            
                <a href="../9-develop-sym-debugger/3-高级功能扩展/103-howto_paging_output.html">
            
                    
                    9.3.103 Implementing Paged Output
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3.5" data-path="../9-develop-sym-debugger/3-高级功能扩展/104-howto_read_separate_dwarfdata.html">
            
                <a href="../9-develop-sym-debugger/3-高级功能扩展/104-howto_read_separate_dwarfdata.html">
            
                    
                    9.3.104 Reading Separately Stored DWARF Data
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3.6" data-path="../9-develop-sym-debugger/3-高级功能扩展/105-howto_guess_substitutepath.html">
            
                <a href="../9-develop-sym-debugger/3-高级功能扩展/105-howto_guess_substitutepath.html">
            
                    
                    9.3.105 Automatic Source File Path Mapping
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3.7" data-path="../9-develop-sym-debugger/3-高级功能扩展/106-howto_redirect_target_io.html">
            
                <a href="../9-develop-sym-debugger/3-高级功能扩展/106-howto_redirect_target_io.html">
            
                    
                    9.3.106 Implementing Target Process IO Redirection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3.8" data-path="../9-develop-sym-debugger/3-高级功能扩展/107-howto_customize_tinydbg.html">
            
                <a href="../9-develop-sym-debugger/3-高级功能扩展/107-howto_customize_tinydbg.html">
            
                    
                    9.3.107 Supporting User Preferences
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3.9" data-path="../9-develop-sym-debugger/3-高级功能扩展/108-howto_accept_multiclient.html">
            
                <a href="../9-develop-sym-debugger/3-高级功能扩展/108-howto_accept_multiclient.html">
            
                    
                    9.3.108 Supporting Multi-client Debug Mode
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3.10" data-path="../9-develop-sym-debugger/3-高级功能扩展/109-howto_transcript_debugging.html">
            
                <a href="../9-develop-sym-debugger/3-高级功能扩展/109-howto_transcript_debugging.html">
            
                    
                    9.3.109 Supporting Debug Activity Logging
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../10-extras/">
            
                <a href="../10-extras/">
            
                    
                    10 Mainstream Debugging Technology Analysis
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="../10-extras/1-development-of-debugger.html">
            
                <a href="../10-extras/1-development-of-debugger.html">
            
                    
                    10.1 Debugger Development History
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.2" data-path="../10-extras/2-development-of-logging.html">
            
                <a href="../10-extras/2-development-of-logging.html">
            
                    
                    10.2 Logging System Development History
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.3" data-path="../10-extras/3-development-of-metrics.html">
            
                <a href="../10-extras/3-development-of-metrics.html">
            
                    
                    10.3 Metrics System Development History
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.4" data-path="../10-extras/4-development-of-tracing.html">
            
                <a href="../10-extras/4-development-of-tracing.html">
            
                    
                    10.4 Tracing System Development History
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.5" data-path="../10-extras/5-development-of-bisect.html">
            
                <a href="../10-extras/5-development-of-bisect.html">
            
                    
                    10.5 Bisect Development History
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.6" data-path="../10-extras/6-development-of-ebpf.html">
            
                <a href="../10-extras/6-development-of-ebpf.html">
            
                    
                    10.6 eBPF Development History
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.7" data-path="../10-extras/7-development-of-replay.html">
            
                <a href="../10-extras/7-development-of-replay.html">
            
                    
                    10.7 Record and Replay Development History
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.8" data-path="../10-extras/8-development-of-debug-dsys.html">
            
                <a href="../10-extras/8-development-of-debug-dsys.html">
            
                    
                    10.8 Distributed Debugging Development History
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="../11-thanks/">
            
                <a href="../11-thanks/">
            
                    
                    11 Acknowledgments
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="../12-appendix/">
            
                <a href="../12-appendix/">
            
                    
                    12 Appendix
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.1" data-path="../12-appendix/1-go-programme-start.html">
            
                <a href="../12-appendix/1-go-programme-start.html">
            
                    
                    12.1 Go Program Startup Process
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.2" data-path="../12-appendix/2-auto-trace-cloned-threads.html">
            
                <a href="../12-appendix/2-auto-trace-cloned-threads.html">
            
                    
                    12.2 Automatic Thread Tracing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.3" data-path="../12-appendix/3-git-bisect.html">
            
                <a href="../12-appendix/3-git-bisect.html">
            
                    
                    12.3 git bisect
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.4" data-path="../12-appendix/80-go-tool-compile.html">
            
                <a href="../12-appendix/80-go-tool-compile.html">
            
                    
                    12.10 Compilation Toolchain/compile
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5" data-path="../12-appendix/81-go-tool-asm.html">
            
                <a href="../12-appendix/81-go-tool-asm.html">
            
                    
                    12.11 Compilation Toolchain/asm
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.6" data-path="../12-appendix/82-go-tool-link.html">
            
                <a href="../12-appendix/82-go-tool-link.html">
            
                    
                    12.12 Compilation Toolchain/link
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.7" data-path="../12-appendix/90-why-buildid-loaded.html">
            
                <a href="../12-appendix/90-why-buildid-loaded.html">
            
                    
                    12.13 More: GNU build-id+gobuildid
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.8" data-path="../12-appendix/91-syntax-and-semantic-analysis.html">
            
                <a href="../12-appendix/91-syntax-and-semantic-analysis.html">
            
                    
                    12.14 More: Syntax Analysis vs Semantic Analysis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.9" data-path="../12-appendix/92-why-gdb-uses-symtab.html">
            
                <a href="../12-appendix/92-why-gdb-uses-symtab.html">
            
                    
                    12.15 More: Why GDB Uses Symbol Table+DWARF
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >5.2 Debugger Example</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h2 id="debugger-skeleton">Debugger Skeleton</h2>
<p>Based on our previous considerations, we have initially implemented a debugger skeleton called <code>godbg</code>, which roughly includes the interactive capabilities we need. Later, we will implement instruction-level debugging and symbol-level debugging step by step on this foundation.</p>
<p>Let&apos;s first look at the execution effect of godbg, then briefly introduce the source code organization to help readers understand which part of the code corresponds to the explained functionality points. This will make it easier to match subsequent new chapter content and source code.</p>
<h3 id="running-effect">Running Effect</h3>
<h4 id="debugger-help-information">Debugger Help Information</h4>
<p><code>godbg help</code> is used to display help information when starting the debugger. We can see it has several subcommands: attach, core, and exec, which correspond to different ways of starting the debugger, and help is used to view the help information for godbg and the above debugging commands.</p>
<pre><code class="lang-bash">$ godbg <span class="hljs-built_in">help</span>

godbg is a symbol-level debugger <span class="hljs-keyword">for</span> Go programs, developed with learning as the driving purpose.
We hope our work can open a door to understanding the computer world <span class="hljs-keyword">for</span> more people. You<span class="hljs-string">&apos;re welcome!

Usage:
  godbg [flags]
  godbg [command]

Available Commands:
  attach      Debug running process
  core        Debug core dump
  exec        Debug executable program
  help        Help about any command

Flags:
      --config string   config file (default is $HOME/.godbg.yaml)
  -h, --help            help for godbg

Use &quot;godbg [command] --help&quot; for more information about a command.
</span></code></pre>
<h4 id="debugger-debugging-session-interface">Debugger Debugging Session Interface</h4>
<p>When godbg starts, it will list the debugger&apos;s supported command information by popping up a prompt list. This is only shown once when godbg starts. To ensure the debugging session is not polluted, no prompt information is displayed when there is no user input.</p>
<p>After the debugger starts successfully, it will use &quot;<strong>godbg&gt;</strong>&quot; to indicate the current debugging session. We enter debugging commands in this session to complete corresponding debugging actions.</p>
<p><img src="assets/godbg_prompt1.png" alt="godbg prompt showAtStart"></p>
<p>Taking the clear breakpoint operation as an example, clear is for clearing a single breakpoint, and clearall is for clearing all breakpoints. When we type <code>cl</code>, it can match both <code>clear</code> and <code>clearall</code> commands. Developers can move through the candidate list using the <code>tab</code> key or <code>arrow-down</code>, and select a list item with <code>enter</code>.</p>
<p><img src="assets/godbg_prompt2.png" alt="godbg prompt commands"></p>
<p>Let&apos;s look at another example of command parameter auto-completion. Taking the list command for viewing source code as an example, it will return source code information involved in the process, such as main.go and helloworld.go here, making it easier for users to choose and debug.</p>
<p><img src="assets/godbg_prompt3.png" alt="godbg prompt suggestions"></p>
<p>This is the running effect display of the debugging session interface.</p>
<blockquote>
<p>NOTE: It&apos;s necessary to mention that this section was written based on the debugger version implemented with cobra-prompt. In subsequent development, we removed the cobra-prompt auto-completion method and switched to an auto-completion method that causes less interference to users. The documentation hasn&apos;t been updated yet.</p>
<p>Readers don&apos;t need to worry too much, as this inconsistency won&apos;t bring much burden to learning. Later, we will update the interaction interface based on the latest implementation.</p>
</blockquote>
<h4 id="displaying-help-information-in-session">Displaying Help Information in Session</h4>
<p>The debugger supports multiple debugging commands in the debugging session. What are the functions of these debugging commands, and how are they used?</p>
<p>Running the help command &quot;<strong>godbg&gt; help</strong>&quot; inside the debugger will list all commands supported by the debugger and their function descriptions, and these commands are categorized by function. For example, breakpoint-related commands break, clear, and clearall are all placed under the &quot;<strong>[breakpoint]</strong>&quot; group, code-related commands like list and disass are all placed under the &quot;<strong>[code]</strong>&quot; group, control flow-related commands like next, step, and finish are all placed under &quot;<strong>[ctrlflow]</strong>&quot;, and there are other debugging commands.</p>
<pre><code class="lang-bash">godbg&gt; <span class="hljs-built_in">help</span>
interactive debugging commands

[breakpoint]
<span class="hljs-built_in">break</span> &lt;locspec&gt; :    Add breakpoint <span class="hljs-keyword">in</span> <span class="hljs-built_in">source</span> code
clear &lt;n&gt;       :    Clear breakpoint with specified number
clearall &lt;n&gt;    :    Clear all breakpoints

[code]
disass &lt;locspec&gt;:    Disassemble machine instructions
list &lt;linespec&gt; :    View <span class="hljs-built_in">source</span> code information

[ctrlflow]
finish          :    Exit current <span class="hljs-keyword">function</span>
next            :    Execute one statement
step            :    Execute one instruction

[information]
bt              :    Print call stack information
display &lt;var|reg&gt;:    Always display variable or register value
frame           :    Select stack frame <span class="hljs-keyword">in</span> call stack
<span class="hljs-built_in">print</span> &lt;var|reg&gt; :    Print variable or register value
ptypes &lt;variable&gt;:    Print variable <span class="hljs-built_in">type</span> information
<span class="hljs-built_in">set</span> &lt;var|reg&gt;=&lt;value&gt;:    Set variable or register value

[other]
<span class="hljs-built_in">exit</span>            :    End debugging session
<span class="hljs-built_in">help</span> [<span class="hljs-built_in">command</span>]  :    Help about any <span class="hljs-built_in">command</span>
</code></pre>
<p>If you want to know how to use a specific debugging command in detail, you can run &quot;<strong>godbg&gt; help <code>cmd</code></strong>&quot;. For example, to view the usage of the break command, run &quot;<strong>godbg&gt; help break</strong>&quot;.</p>
<h4 id="executing-debugging-commands-in-session">Executing Debugging Commands in Session</h4>
<p>Here, let&apos;s demonstrate how to execute debugging actions in the debugging session using displaying source code information as an example. Execute the debugging command &quot;<strong>godbg&gt; list main.go</strong>&quot; in the debugging session to display source code information in main.go.</p>
<pre><code class="lang-bash">godbg&gt; list main.go
list codes <span class="hljs-keyword">in</span> file
</code></pre>
<p>We tried running the command <code>list main.go</code> and found that it only output one line of statement without actually printing the source code.</p>
<p>Don&apos;t worry, this is what we mentioned earlier - this is just a debugger skeleton. We have indeed set up the framework, and in the following chapters, we will implement each command step by step, first implementing the instruction-level debugger, then the symbol-level debugger.</p>
<h3 id="code-implementation">Code Implementation</h3>
<p>For the debugger code, see: <a href="https://github.com/debugger101/golang-debugger-lessons/tree/master/0_godbg" target="_blank">golang-debugger-lessons/0_godbg</a>. Let&apos;s take a brief look at the implementation.</p>
<h4 id="directory-structure">Directory Structure</h4>
<p>The source code directory structure of godbg is as follows (some file entries are omitted to save space):</p>
<pre><code class="lang-bash">tree godbg
godbg                         : Project root directory
&#x251C;&#x2500;&#x2500; LICENSE                   : Copyright information
&#x251C;&#x2500;&#x2500; cmd                       : Commands <span class="hljs-keyword">for</span> starting debugging
&#x2502;   &#x251C;&#x2500;&#x2500; root.go               : rootCmd binds subcommands core, <span class="hljs-built_in">exec</span>, attach
&#x2502;   &#x251C;&#x2500;&#x2500; attach.go
&#x2502;   &#x251C;&#x2500;&#x2500; core.go
&#x2502;   &#x251C;&#x2500;&#x2500; exec.go
&#x2502;   &#x251C;&#x2500;&#x2500; debug                 : Debugging commands available <span class="hljs-keyword">in</span> debugging session
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; root_debug.go     : debugRootCmd binds many debugging session commands
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; backtrace.go
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; break.go
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; clear.go
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; clearall.go
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; disass.go
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; display.go
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; exit.go
....
&#x251C;&#x2500;&#x2500; go.mod
&#x251C;&#x2500;&#x2500; go.sum
&#x251C;&#x2500;&#x2500; main.go                  : Program entry point main.main
&#x251C;&#x2500;&#x2500; syms                     : Symbol layer, <span class="hljs-keyword">for</span> implementing mapping between instruction addresses and <span class="hljs-built_in">source</span> code, symbol lookup, etc.
&#x2514;&#x2500;&#x2500; target                   : Target layer, <span class="hljs-keyword">for</span> implementing low-level operations, such as instruction patch <span class="hljs-keyword">for</span> setting breakpoints, etc.
    &#x251C;&#x2500;&#x2500; backtrace.go
    &#x251C;&#x2500;&#x2500; breakpoint.go
    &#x251C;&#x2500;&#x2500; call.go
    &#x251C;&#x2500;&#x2500; continue.go
    &#x251C;&#x2500;&#x2500; disassemble.go
    ....
</code></pre>
<p>We can see that we have already included most of the commands needed for debugging, but they haven&apos;t been implemented yet. We will implement each debugging command step by step later. The functional logic of command implementation may involve the corresponding <code>${command}.go</code> file, as well as related code in the symbol layer syms package and target layer target package.</p>
<p>After introducing the code organization, when explaining the implementation of a debugging command or functionality later, readers should be able to quickly find the corresponding implementation code.</p>
<h4 id="source-code-analysis-command-management-logic">Source Code Analysis: Command Management Logic</h4>
<p>Those familiar with cobra programming will know that this debugger is based on cobra for command management after reading main.go.</p>
<pre><code class="lang-go"><span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> <span class="hljs-string">&quot;godbg/cmd&quot;</span>

<span class="hljs-keyword">func</span> main() {
    cmd.Execute()
}
</code></pre>
<p>The subcommands exec, debug, and core under godbg correspond to cmd/exec.go, cmd/debug.go, and cmd/core.go respectively. They are all subcommands of rootCmd defined in cmd/root.go.</p>
<pre><code class="lang-go"><span class="hljs-keyword">var</span> rootCmd = &amp;cobra.Command{
    Use:   <span class="hljs-string">&quot;godbg&quot;</span>,
    Short: <span class="hljs-string">&quot;godbg is a symbol-level debugger for Go language&quot;</span>,
    Long: <span class="hljs-string">`
godbg is a symbol-level debugger for Go programs, developed with learning as the driving purpose.
We hope our work can open a door to understanding the computer world for more people. You&apos;re welcome!`</span>,
    <span class="hljs-comment">// Uncomment the following line if your bare application</span>
    <span class="hljs-comment">// has an action associated with it:</span>
    Run: <span class="hljs-keyword">func</span>(cmd *cobra.Command, args []<span class="hljs-keyword">string</span>) {
        <span class="hljs-comment">// TODO comment out this, this should be enabled only in debugging phase</span>
        debug.NewDebugShell().Run()
    },
}
</code></pre>
<p>When we execute godbg, it executes the <code>rootCmd.Run()</code> logic. When we execute <code>godbg exec</code>, it executes the <code>execCmd.Run()</code> logic. This is easy to understand and get started with.</p>
<pre><code class="lang-go"><span class="hljs-keyword">var</span> execCmd = &amp;cobra.Command{
    Use:   <span class="hljs-string">&quot;exec &lt;prog&gt;&quot;</span>,
    Short: <span class="hljs-string">&quot;Debug executable program&quot;</span>,
    Long:  <span class="hljs-string">`Debug executable program`</span>,
    Run: <span class="hljs-keyword">func</span>(cmd *cobra.Command, args []<span class="hljs-keyword">string</span>) {
        <span class="hljs-comment">// TODO start process and attach</span>
        fmt.Printf(<span class="hljs-string">&quot;exec %s\n&quot;</span>, strings.Join(args, <span class="hljs-string">&quot;&quot;</span>))

        debug.NewDebugShell().Run()
    },
}

<span class="hljs-keyword">func</span> init() {
    rootCmd.AddCommand(execCmd)
}
</code></pre>
<p>The above is the exec command to be executed when <code>godbg exec &lt;prog&gt;</code>. It first starts the process and attaches to it. After preparation is complete, it starts a debugging session where we continue to input debugging commands for debugging.</p>
<h4 id="source-code-analysis-debugging-session-command-management">Source Code Analysis: Debugging Session Command Management</h4>
<p>godbg/cmd/debug/root_debug.go contains a command manager built using cobra-prompt, which combines cobra command management with go-prompt&apos;s auto-suggestion and completion capabilities. It&apos;s very suitable for managing scenarios with many commands, many command options, many command candidate parameters, and frequent command usage, such as in debugging sessions.</p>
<p>Just execute <code>debug.NewDebugShell().Run()</code> to quickly simulate the logic of user input, execution processing, and completion of debugging information display in a debugging session.</p>
<pre><code class="lang-go"><span class="hljs-comment">// NewDebugShell creates an interaction manager specifically for debugging</span>
<span class="hljs-keyword">func</span> NewDebugShell() *cobraprompt.CobraPrompt {

    fn := <span class="hljs-keyword">func</span>() <span class="hljs-keyword">func</span>(cmd *cobra.Command) error {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">func</span>(cmd *cobra.Command) error {
            usage := groupDebugCommands(cmd)
            fmt.Println(usage)
            <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>
        }
    }
    debugRootCmd.SetUsageFunc(fn())

    <span class="hljs-keyword">return</span> &amp;cobraprompt.CobraPrompt{
        RootCmd:                debugRootCmd,
        DynamicSuggestionsFunc: dynamicSuggestions,
        ResetFlagsFlag:         <span class="hljs-literal">true</span>,
        GoPromptOptions: []prompt.Option{
            prompt.OptionTitle(description),
            prompt.OptionPrefix(prefix),
            prompt.OptionSuggestionBGColor(prompt.DarkBlue),
            prompt.OptionDescriptionBGColor(prompt.DarkBlue),
            prompt.OptionSelectedSuggestionBGColor(prompt.Red),
            prompt.OptionSelectedDescriptionBGColor(prompt.Red),
            <span class="hljs-comment">// here, hide prompt dropdown list</span>
            <span class="hljs-comment">// TODO do we have a better way to show/hide the prompt dropdown list?</span>
            prompt.OptionMaxSuggestion(<span class="hljs-number">10</span>),
            prompt.OptionShowCompletionAtStart(),
        },
        EnableSilentPrompt: <span class="hljs-literal">true</span>,
        EnableShowAtStart:  <span class="hljs-literal">true</span>,
    }
}
</code></pre>
<p>For the implementation of custom auto-suggestion information, you can refer to the function implementation <code>dynamicSuggestions(string, prompt.Document)</code>.</p>
<pre><code class="lang-go"><span class="hljs-keyword">func</span> dynamicSuggestions(annotation <span class="hljs-keyword">string</span>, _ prompt.Document) []prompt.Suggest {
    <span class="hljs-keyword">switch</span> annotation {
    <span class="hljs-keyword">case</span> suggestionListSourceFiles:
        <span class="hljs-keyword">return</span> GetSourceFiles()
    <span class="hljs-keyword">default</span>:
        <span class="hljs-keyword">return</span> []prompt.Suggest{}
    }
}

<span class="hljs-comment">// list &#x8F93;&#x5165;list&#x65F6;&#x8FD4;&#x56DE;&#x5019;&#x9009;&#x6E90;&#x6587;&#x4EF6;&#x540D;&#x4F5C;&#x4E3A;&#x63D0;&#x793A;&#x8865;&#x5168;&#x4FE1;&#x606F;</span>
<span class="hljs-keyword">func</span> GetSourceFiles() []prompt.Suggest {
    <span class="hljs-keyword">return</span> []prompt.Suggest{
        {Text: <span class="hljs-string">&quot;main.go&quot;</span>, Description: <span class="hljs-string">&quot;main.go&quot;</span>},
        {Text: <span class="hljs-string">&quot;helloworld.go&quot;</span>, Description: <span class="hljs-string">&quot;helloworld.go&quot;</span>},
    }
}
</code></pre>
<p>&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;cobra-prompt&#x89C4;&#x5B9A;&#x4E86;cobra command&#x53EA;&#x6709;&#x6DFB;&#x52A0;&#x4E86; <code>&lt;cobraprompt.CALLBACK_ANNOTATION,&quot;value&quot;&gt;</code>&#x7684;annotation&#x9879;&#x4E4B;&#x540E;&#x624D;&#x4F1A;&#x6FC0;&#x53D1;&#x547D;&#x4EE4;&#x53C2;&#x6570;&#x7684;&#x81EA;&#x52A8;&#x8865;&#x5168;&#x903B;&#x8F91;&#x3002;&#x4EE5;list&#x547D;&#x4EE4;&#x5C06;&#x6E90;&#x6587;&#x4EF6;&#x5217;&#x8868;&#x4F5C;&#x4E3A;&#x8865;&#x5168;&#x4FE1;&#x606F;&#x4E3A;&#x4F8B;&#xFF0C;list&#x547D;&#x4EE4;&#x5728;Annotations&#x8FD9;&#x4E2A;map&#x5B57;&#x6BB5;&#x4E2D;&#x6DFB;&#x52A0;&#x4E86;CALLBACK_ANNOTATION&#x7684;kvpair.</p>
<pre><code class="lang-go"><span class="hljs-keyword">var</span> listCmd = &amp;cobra.Command{
    Use:     <span class="hljs-string">&quot;list &lt;linespec&gt;&quot;</span>,
    Short:   <span class="hljs-string">&quot;&#x67E5;&#x770B;&#x6E90;&#x7801;&#x4FE1;&#x606F;&quot;</span>,
    Aliases: []<span class="hljs-keyword">string</span>{<span class="hljs-string">&quot;l&quot;</span>},
    Annotations: <span class="hljs-keyword">map</span>[<span class="hljs-keyword">string</span>]<span class="hljs-keyword">string</span>{
        cmdGroupKey:                     cmdGroupSource,
        cobraprompt.CALLBACK_ANNOTATION: suggestionListSourceFiles,
    },
    Run: <span class="hljs-keyword">func</span>(cmd *cobra.Command, args []<span class="hljs-keyword">string</span>) {
        fmt.Println(<span class="hljs-string">&quot;list codes in file&quot;</span>)
    },
}
</code></pre>
<p>&#x8C03;&#x8BD5;&#x4F1A;&#x8BDD;&#x4E2D;&#x8FD0;&#x884C; <code>list main.go</code></p>
<pre><code class="lang-bash">godbg&gt; list main.go
list codes <span class="hljs-keyword">in</span> file
</code></pre>
<p>&#x6211;&#x4EEC;&#x8BD5;&#x8FD0;&#x884C;&#x547D;&#x4EE4; <code>list main.go</code>&#x53D1;&#x73B0;&#x8F93;&#x51FA;&#x4E86;&#x4E00;&#x884C;&#x8BED;&#x53E5;&#xFF0C;&#x4EE3;&#x8868;&#x547D;&#x4EE4;&#x5DF2;&#x7ECF;&#x987A;&#x5229;&#x6267;&#x884C;&#x4E86;&#xFF0C;&#x6211;&#x4EEC;&#x540E;&#x9762;&#x4F1A;&#x5B9E;&#x73B0;&#x771F;&#x5B9E;&#x7684;&#x5C55;&#x793A;&#x6E90;&#x4EE3;&#x7801;&#x7684;&#x529F;&#x80FD;&#x3002;</p>
<p>Now, we&apos;ve roughly introduced the skeleton of godbg, and I believe that readers are eager to enter the next step of development :) .</p>
<blockquote>
<p>Note&#xFF1A;&#x5728;&#x8BE5;&#x8C03;&#x8BD5;&#x5668;demo&#x7684;&#x5B8C;&#x6574;&#x7248;&#x5B9E;&#x73B0;&#x4E2D;&#xFF0C;&#x8BE6;&#x89C1; <a href="https://github.com/hitzhangjie/godbg" target="_blank">hitzhangjie/godbg</a> &#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x5DF2;&#x7ECF;&#x5F7B;&#x5E95;&#x79FB;&#x9664;&#x4E86;cobraprompt&#xFF0C;&#x52A8;&#x6001;&#x63D0;&#x793A;&#x5BF9;&#x8C03;&#x8BD5;&#x4F1A;&#x8BDD;&#x5E72;&#x6270;&#x6027;&#x6709;&#x70B9;&#x5927;&#xFF0C;&#x5728;&#x5176;&#x4ED6;&#x7684;&#x975E;&#x9AD8;&#x9891;&#x8F93;&#x5165;&#x7684;&#x547D;&#x4EE4;&#x884C;&#x7A0B;&#x5E8F;&#x4E2D;&#x4F7F;&#x7528;&#x66F4;&#x5408;&#x9002;&#x3002;</p>
</blockquote>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="1-debugger_skeleton.html" class="navigation navigation-prev " aria-label="Previous page: 5.1 Debugger Overview">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../6-develop-inst-debugger/" class="navigation navigation-next " aria-label="Next page: 6 Developing Go Instruction-Level Debugger">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"5.2 Debugger Example","level":"1.5.2","depth":2,"next":{"title":"6 Developing Go Instruction-Level Debugger","level":"1.6","depth":1,"path":"6-develop-inst-debugger/README.md","ref":"6-develop-inst-debugger/README.md","articles":[{"title":"6.1 Process Launch","level":"1.6.1","depth":2,"path":"6-develop-inst-debugger/1-process_start.md","ref":"6-develop-inst-debugger/1-process_start.md","articles":[]},{"title":"6.2 Process Attach","level":"1.6.2","depth":2,"path":"6-develop-inst-debugger/2-process_attach.md","ref":"6-develop-inst-debugger/2-process_attach.md","articles":[]},{"title":"6.3 Launch & Attach","level":"1.6.3","depth":2,"path":"6-develop-inst-debugger/3-process_start_attach.md","ref":"6-develop-inst-debugger/3-process_start_attach.md","articles":[]},{"title":"6.4 Debug Session","level":"1.6.4","depth":2,"path":"6-develop-inst-debugger/4-debug-session.md","ref":"6-develop-inst-debugger/4-debug-session.md","articles":[]},{"title":"6.5 Disassembly","level":"1.6.5","depth":2,"path":"6-develop-inst-debugger/5-disassemble.md","ref":"6-develop-inst-debugger/5-disassemble.md","articles":[]},{"title":"6.6 Adding Breakpoints","level":"1.6.6","depth":2,"path":"6-develop-inst-debugger/6-breakpoint.md","ref":"6-develop-inst-debugger/6-breakpoint.md","articles":[]},{"title":"6.7 Listing Breakpoints","level":"1.6.7","depth":2,"path":"6-develop-inst-debugger/7-breakpoints.md","ref":"6-develop-inst-debugger/7-breakpoints.md","articles":[]},{"title":"6.8 Removing Breakpoints","level":"1.6.8","depth":2,"path":"6-develop-inst-debugger/8-clear.md","ref":"6-develop-inst-debugger/8-clear.md","articles":[]},{"title":"6.9 Clearing All Breakpoints","level":"1.6.9","depth":2,"path":"6-develop-inst-debugger/9-clearall.md","ref":"6-develop-inst-debugger/9-clearall.md","articles":[]},{"title":"6.10 Stepping Operations","level":"1.6.10","depth":2,"path":"6-develop-inst-debugger/10-step.md","ref":"6-develop-inst-debugger/10-step.md","articles":[]},{"title":"6.11 Running to Breakpoint","level":"1.6.11","depth":2,"path":"6-develop-inst-debugger/11-continue.md","ref":"6-develop-inst-debugger/11-continue.md","articles":[]},{"title":"6.12 Printing Memory Data","level":"1.6.12","depth":2,"path":"6-develop-inst-debugger/12-pmem.md","ref":"6-develop-inst-debugger/12-pmem.md","articles":[]},{"title":"6.13 Printing Register Data","level":"1.6.13","depth":2,"path":"6-develop-inst-debugger/13-pregs.md","ref":"6-develop-inst-debugger/13-pregs.md","articles":[]},{"title":"6.14 Modifying Memory Data","level":"1.6.14","depth":2,"path":"6-develop-inst-debugger/14-set-mem.md","ref":"6-develop-inst-debugger/14-set-mem.md","articles":[]},{"title":"6.15 Modifying Register Data","level":"1.6.15","depth":2,"path":"6-develop-inst-debugger/15-set-regs.md","ref":"6-develop-inst-debugger/15-set-regs.md","articles":[]},{"title":"6.20 Tracing Multi-threaded Programs 1","level":"1.6.16","depth":2,"path":"6-develop-inst-debugger/20-trace_new_threads.md","ref":"6-develop-inst-debugger/20-trace_new_threads.md","articles":[]},{"title":"6.21 Tracing Multi-threaded Programs 2","level":"1.6.17","depth":2,"path":"6-develop-inst-debugger/21-trace_old_threads.md","ref":"6-develop-inst-debugger/21-trace_old_threads.md","articles":[]},{"title":"6.80 Understanding ASLR","level":"1.6.18","depth":2,"path":"6-develop-inst-debugger/80-aslr.md","ref":"6-develop-inst-debugger/80-aslr.md","articles":[]},{"title":"6.99 More...","level":"1.6.19","depth":2,"path":"6-develop-inst-debugger/99-more.md","ref":"6-develop-inst-debugger/99-more.md","articles":[]}]},"previous":{"title":"5.1 Debugger Overview","level":"1.5.1","depth":2,"path":"5-debugger-skeleton/1-debugger_skeleton.md","ref":"5-debugger-skeleton/1-debugger_skeleton.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["md-toc"],"pluginsConfig":{"intopic-toc":{"selector":".markdown-section h1, .markdown-section h2, .markdown-section h3, .markdown-section h4, .markdown-section h5, .markdown-section h6","visible":true,"label":{"en":"In This Article","zh":"本文目录"}},"md-toc":{"label":"In this article","selector":".markdown-section h2","visible":true},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"5-debugger-skeleton/2-debugger_demo.md","mtime":"2025-06-15T08:51:47.380Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2025-06-15T18:01:33.391Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-md-toc/anchor.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-md-toc/gumshoe.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-md-toc/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

